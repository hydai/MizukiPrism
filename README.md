<p align="center">
  <img src="MizukiPrism-Banner.png" alt="MizukiPrism" width="600" />
</p>

# MizukiPrism

Song catalog and player for VTuber 浠Mizuki's karaoke livestream archive — browse songs, watch timestamped VOD clips, and follow along with synced lyrics.

## Features

- **Song Catalog** — searchable, sortable song list with album art thumbnails
- **Timestamped Playback** — play any performance directly from the VOD at the exact timestamp
- **Mini Player & Queue** — persistent playback controls with drag-and-drop queue management
- **Synced Lyrics** — karaoke-style lyrics that scroll with playback (powered by LRCLIB)
- **Album Art** — cover images from Deezer displayed across all UI positions
- **Fan Playlists** — create and manage personal playlists (stored locally)
- **MizukiLens CLI** — data pipeline tool for curators to manage the song catalog and metadata

## Tech Stack

| Layer | Technology |
|-------|-----------|
| Frontend | Next.js 16, React 19, TypeScript, Tailwind CSS |
| Icons | Lucide React |
| Testing | Playwright (E2E), pytest (CLI) |
| CLI Tool | Python 3.10+, Click, Rich, Textual |
| Deployment | GitHub Pages (static) |

## Getting Started

### Prerequisites

- Node.js 20+
- Python 3.10+ (for MizukiLens CLI)

### Frontend

```bash
npm install
npm run dev        # http://localhost:3000
```

### MizukiLens CLI

```bash
cd tools/mizukilens
python3 -m venv .venv
.venv/bin/pip install -e .
mizukilens --help
```

## Project Structure

```
app/                    Next.js frontend
├── components/         React components
├── contexts/           State management (Player, Playlist, Auth)
├── api/                API routes
├── page.tsx            Main catalog page
lib/                    Shared types and utilities
data/                   Static JSON data files
├── songs.json          Song catalog
├── streams.json        VOD metadata
└── metadata/           Album art + lyrics (generated by CLI)
tools/mizukilens/       Python CLI for data curation
tests/                  Playwright E2E tests
```

## Data Pipeline

Song data flows through a curator-managed pipeline:

```
YouTube VODs → MizukiLens CLI → data/*.json → git commit → GitHub Pages → Fans
```

1. **Discover** — `mizukilens fetch` scrapes YouTube for new livestream VODs
2. **Extract** — `mizukilens extract` pulls song timestamps from comments/descriptions
3. **Review** — `mizukilens review` opens a TUI for curators to verify and edit
4. **Export/Import** — `mizukilens export` + `mizukilens import` writes to `data/songs.json`
5. **Metadata** — `mizukilens metadata fetch` enriches songs with album art and lyrics from Deezer/LRCLIB

## Testing

```bash
# Frontend E2E (requires dev server running)
npx playwright test

# Python CLI
cd tools/mizukilens
.venv/bin/python3 -m pytest tests/ -v
```

## Specifications

- [SPEC.md](SPEC.md) — Core song catalog and player
- [SPEC-MizukiLens.md](SPEC-MizukiLens.md) — MizukiLens data pipeline CLI
- [SPEC-Metadata.md](SPEC-Metadata.md) — Album art and lyrics metadata integration
- [SPEC-Auth.md](SPEC-Auth.md) — Fan authentication
